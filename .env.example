# AI Threat Hunting Simulator Configuration

# Analysis Engine API
ANALYSIS_API_HOST=0.0.0.0
ANALYSIS_API_PORT=8000
ANALYSIS_API_DEBUG=false

# SOC Dashboard UI
UI_PORT=3000
API_BASE_URL=http://localhost:8000

# Telemetry Generation
DEFAULT_ACCOUNT_ID=123456789012
DEFAULT_REGION=us-east-1
DEFAULT_TENANT_ID=synthetic-tenant-001

# Output Paths
OUTPUT_DIR=./output
TELEMETRY_DIR=./output/telemetry
REPORTS_DIR=./output/reports

# Scenario Configuration
SCENARIO_DURATION_HOURS=2
EVENT_NOISE_RATIO=0.3  # 30% benign background events

# Analysis Engine Tuning
CORRELATION_TIME_WINDOW_MINUTES=60
MIN_EVENTS_FOR_ALERT=3
RISK_SCORE_THRESHOLD=0.7

# Logging
LOG_LEVEL=INFO
LOG_FORMAT=json
# LOG_FILE=  # Optional: Path to log file

# ===== LLM Integration (AI-Powered Analysis) =====
# Enable AI-powered threat narratives, IOC extraction, and response planning
# If disabled (LLM_PROVIDER=none), uses high-quality template-based analysis
LLM_PROVIDER=none  # Options: none, openai, anthropic

# OpenAI Configuration (required if LLM_PROVIDER=openai)
# Get API key at: https://platform.openai.com/api-keys
# OPENAI_API_KEY=sk-...
# Recommended models: gpt-4-turbo-preview, gpt-4, gpt-3.5-turbo

# Anthropic Configuration (required if LLM_PROVIDER=anthropic)
# Get API key at: https://console.anthropic.com/
# ANTHROPIC_API_KEY=sk-ant-...
# Recommended models: claude-3-5-sonnet-20241022, claude-3-opus-20240229

# Model name (optional, uses provider default if not specified)
# LLM_MODEL=gpt-4-turbo-preview

# LLM Parameters
LLM_TEMPERATURE=0.3  # Lower = more deterministic (0.0-2.0)
LLM_MAX_TOKENS=2000  # Maximum tokens in response

# ===== Threat Intelligence Integration =====
# Enable real-time threat intelligence enrichment for IOCs
# Provides reputation scoring, malware analysis, and threat context
ENABLE_THREAT_INTEL=false

# AbuseIPDB (IP reputation and abuse reports)
# Get free API key (1000 requests/day) at: https://www.abuseipdb.com/api
# ABUSEIPDB_API_KEY=

# VirusTotal (File/URL/IP/Domain reputation and malware analysis)
# Get free API key (4 requests/min) at: https://www.virustotal.com/gui/join-us
# VIRUSTOTAL_API_KEY=

# Cache TTL (seconds) - how long to cache threat intel results
THREAT_INTEL_CACHE_TTL=3600  # 1 hour

# ===== Database Persistence =====
# Store analysis results, sessions, and IOCs in database
DB_CONNECTION_STRING=sqlite:///./data/threat_hunting.db
# For PostgreSQL: postgresql://user:password@localhost:5432/threat_hunting
# For MySQL: mysql://user:password@localhost:3306/threat_hunting
DB_POOL_SIZE=5
DB_MAX_OVERFLOW=10
DB_ECHO=false  # Set to true for SQL debugging

# ===== Security & CORS =====
ALLOWED_ORIGINS=http://localhost:3000,http://localhost:3001
# API_KEY=  # Optional: Protect API with authentication
# ADMIN_API_KEY=  # Optional: Admin-only operations
MAX_UPLOAD_SIZE_MB=100
MAX_EVENTS_PER_REQUEST=10000

# ===== Performance & Monitoring =====
ENABLE_METRICS=false  # Prometheus metrics endpoint
METRICS_PORT=9090
# SENTRY_DSN=  # Optional: Sentry error tracking
ENABLE_PROFILING=false  # Performance profiling
STREAMING_CHUNK_SIZE=1000  # Events per chunk for large file streaming
MAX_CONCURRENT_ANALYSES=5  # Max parallel analyses

# ===== Quick Start Examples =====
#
# 1. Template-based (no API keys needed):
#    LLM_PROVIDER=none
#    ENABLE_THREAT_INTEL=false
#
# 2. AI-powered with OpenAI:
#    LLM_PROVIDER=openai
#    OPENAI_API_KEY=sk-...
#    LLM_MODEL=gpt-4-turbo-preview
#
# 3. AI-powered with Anthropic Claude:
#    LLM_PROVIDER=anthropic
#    ANTHROPIC_API_KEY=sk-ant-...
#    LLM_MODEL=claude-3-5-sonnet-20241022
#
# 4. Full AI + Threat Intelligence:
#    LLM_PROVIDER=openai
#    OPENAI_API_KEY=sk-...
#    ENABLE_THREAT_INTEL=true
#    ABUSEIPDB_API_KEY=...
#    VIRUSTOTAL_API_KEY=...
